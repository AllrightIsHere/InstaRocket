{"ast":null,"code":"'use strict';\n\nconst util = require('util');\n\nconst stream = require('stream');\n\nconst is = require('./is');\n\nrequire('./libvips').hasVendoredLibvips();\n/* istanbul ignore next */\n\n\ntry {\n  require('../build/Release/sharp.node');\n} catch (err) {\n  // Bail early if bindings aren't available\n  const help = ['', 'Something went wrong installing the \"sharp\" module', '', err.message, ''];\n\n  if (/NODE_MODULE_VERSION/.test(err.message)) {\n    help.push('- Ensure the version of Node.js used at install time matches that used at runtime');\n  } else if (/invalid ELF header/.test(err.message)) {\n    help.push(`- Ensure \"${process.platform}\" is used at install time as well as runtime`);\n  } else if (/dylib/.test(err.message) && /Incompatible library version/.test(err.message)) {\n    help.push('- Run \"brew update && brew upgrade vips\"');\n  } else if (/Cannot find module/.test(err.message)) {\n    help.push('- Run \"npm rebuild --verbose sharp\" and look for errors');\n  } else {\n    help.push('- Remove the \"node_modules/sharp\" directory then run', '  \"npm install --ignore-scripts=false --verbose\" and look for errors');\n  }\n\n  help.push('- Consult the installation documentation at https://sharp.pixelplumbing.com/install', '- Search for this error at https://github.com/lovell/sharp/issues', '');\n  const error = help.join('\\n');\n  throw new Error(error);\n} // Use NODE_DEBUG=sharp to enable libvips warnings\n\n\nconst debuglog = util.debuglog('sharp');\n/**\n * @constructs sharp\n *\n * Constructor factory to create an instance of `sharp`, to which further methods are chained.\n *\n * JPEG, PNG, WebP or TIFF format image data can be streamed out from this object.\n * When using Stream based output, derived attributes are available from the `info` event.\n *\n * Implements the [stream.Duplex](http://nodejs.org/api/stream.html#stream_class_stream_duplex) class.\n *\n * @example\n * sharp('input.jpg')\n *   .resize(300, 200)\n *   .toFile('output.jpg', function(err) {\n *     // output.jpg is a 300 pixels wide and 200 pixels high image\n *     // containing a scaled and cropped version of input.jpg\n *   });\n *\n * @example\n * // Read image data from readableStream,\n * // resize to 300 pixels wide,\n * // emit an 'info' event with calculated dimensions\n * // and finally write image data to writableStream\n * var transformer = sharp()\n *   .resize(300)\n *   .on('info', function(info) {\n *     console.log('Image height is ' + info.height);\n *   });\n * readableStream.pipe(transformer).pipe(writableStream);\n *\n * @example\n * // Create a blank 300x200 PNG image of semi-transluent red pixels\n * sharp({\n *   create: {\n *     width: 300,\n *     height: 200,\n *     channels: 4,\n *     background: { r: 255, g: 0, b: 0, alpha: 0.5 }\n *   }\n * })\n * .png()\n * .toBuffer()\n * .then( ... );\n *\n * @param {(Buffer|String)} [input] - if present, can be\n *  a Buffer containing JPEG, PNG, WebP, GIF, SVG, TIFF or raw pixel image data, or\n *  a String containing the filesystem path to an JPEG, PNG, WebP, GIF, SVG or TIFF image file.\n *  JPEG, PNG, WebP, GIF, SVG, TIFF or raw pixel image data can be streamed into the object when not present.\n * @param {Object} [options] - if present, is an Object with optional attributes.\n * @param {Boolean} [options.failOnError=true] - by default halt processing and raise an error when loading invalid images.\n *  Set this flag to `false` if you'd rather apply a \"best effort\" to decode images, even if the data is corrupt or invalid.\n * @param {Number|Boolean} [options.limitInputPixels=268402689] - Do not process input images where the number of pixels\n *  (width x height) exceeds this limit. Assumes image dimensions contained in the input metadata can be trusted.\n *  An integral Number of pixels, zero or false to remove limit, true to use default limit of 268402689 (0x3FFF x 0x3FFF).\n * @param {Boolean} [options.sequentialRead=false] - Set this to `true` to use sequential rather than random access where possible.\n *  This can reduce memory usage and might improve performance on some systems.\n * @param {Number} [options.density=72] - number representing the DPI for vector images.\n * @param {Number} [options.pages=1] - number of pages to extract for multi-page input (GIF, TIFF, PDF), use -1 for all pages.\n * @param {Number} [options.page=0] - page number to start extracting from for multi-page input (GIF, TIFF, PDF), zero based.\n * @param {Object} [options.raw] - describes raw pixel input image data. See `raw()` for pixel ordering.\n * @param {Number} [options.raw.width]\n * @param {Number} [options.raw.height]\n * @param {Number} [options.raw.channels] - 1-4\n * @param {Object} [options.create] - describes a new image to be created.\n * @param {Number} [options.create.width]\n * @param {Number} [options.create.height]\n * @param {Number} [options.create.channels] - 3-4\n * @param {String|Object} [options.create.background] - parsed by the [color](https://www.npmjs.org/package/color) module to extract values for red, green, blue and alpha.\n * @returns {Sharp}\n * @throws {Error} Invalid parameters\n */\n\nconst Sharp = function (input, options) {\n  if (arguments.length === 1 && !is.defined(input)) {\n    throw new Error('Invalid input');\n  }\n\n  if (!(this instanceof Sharp)) {\n    return new Sharp(input, options);\n  }\n\n  stream.Duplex.call(this);\n  this.options = {\n    // resize options\n    topOffsetPre: -1,\n    leftOffsetPre: -1,\n    widthPre: -1,\n    heightPre: -1,\n    topOffsetPost: -1,\n    leftOffsetPost: -1,\n    widthPost: -1,\n    heightPost: -1,\n    width: -1,\n    height: -1,\n    canvas: 'crop',\n    position: 0,\n    resizeBackground: [0, 0, 0, 255],\n    useExifOrientation: false,\n    angle: 0,\n    rotationAngle: 0,\n    rotationBackground: [0, 0, 0, 255],\n    rotateBeforePreExtract: false,\n    flip: false,\n    flop: false,\n    extendTop: 0,\n    extendBottom: 0,\n    extendLeft: 0,\n    extendRight: 0,\n    extendBackground: [0, 0, 0, 255],\n    withoutEnlargement: false,\n    kernel: 'lanczos3',\n    fastShrinkOnLoad: true,\n    // operations\n    tintA: 128,\n    tintB: 128,\n    flatten: false,\n    flattenBackground: [0, 0, 0],\n    negate: false,\n    medianSize: 0,\n    blurSigma: 0,\n    sharpenSigma: 0,\n    sharpenFlat: 1,\n    sharpenJagged: 2,\n    threshold: 0,\n    thresholdGrayscale: true,\n    trimThreshold: 0,\n    gamma: 0,\n    gammaOut: 0,\n    greyscale: false,\n    normalise: 0,\n    brightness: 1,\n    saturation: 1,\n    hue: 0,\n    booleanBufferIn: null,\n    booleanFileIn: '',\n    joinChannelIn: [],\n    extractChannel: -1,\n    removeAlpha: false,\n    ensureAlpha: false,\n    colourspace: 'srgb',\n    composite: [],\n    // output\n    fileOut: '',\n    formatOut: 'input',\n    streamOut: false,\n    withMetadata: false,\n    withMetadataOrientation: -1,\n    resolveWithObject: false,\n    // output format\n    jpegQuality: 80,\n    jpegProgressive: false,\n    jpegChromaSubsampling: '4:2:0',\n    jpegTrellisQuantisation: false,\n    jpegOvershootDeringing: false,\n    jpegOptimiseScans: false,\n    jpegOptimiseCoding: true,\n    jpegQuantisationTable: 0,\n    pngProgressive: false,\n    pngCompressionLevel: 9,\n    pngAdaptiveFiltering: false,\n    pngPalette: false,\n    pngQuality: 100,\n    pngColours: 256,\n    pngDither: 1,\n    webpQuality: 80,\n    webpAlphaQuality: 100,\n    webpLossless: false,\n    webpNearLossless: false,\n    webpSmartSubsample: false,\n    webpReductionEffort: 4,\n    tiffQuality: 80,\n    tiffCompression: 'jpeg',\n    tiffPredictor: 'horizontal',\n    tiffPyramid: false,\n    tiffSquash: false,\n    tiffTile: false,\n    tiffTileHeight: 256,\n    tiffTileWidth: 256,\n    tiffXres: 1.0,\n    tiffYres: 1.0,\n    heifQuality: 80,\n    heifLossless: false,\n    heifCompression: 'hevc',\n    tileSize: 256,\n    tileOverlap: 0,\n    tileSkipBlanks: -1,\n    tileBackground: [255, 255, 255, 255],\n    linearA: 1,\n    linearB: 0,\n    // Function to notify of libvips warnings\n    debuglog: debuglog,\n    // Function to notify of queue length changes\n    queueListener: function (queueLength) {\n      Sharp.queue.emit('change', queueLength);\n    }\n  };\n  this.options.input = this._createInputDescriptor(input, options, {\n    allowStream: true\n  });\n  return this;\n};\n\nutil.inherits(Sharp, stream.Duplex);\n/**\n * Take a \"snapshot\" of the Sharp instance, returning a new instance.\n * Cloned instances inherit the input of their parent instance.\n * This allows multiple output Streams and therefore multiple processing pipelines to share a single input Stream.\n *\n * @example\n * const pipeline = sharp().rotate();\n * pipeline.clone().resize(800, 600).pipe(firstWritableStream);\n * pipeline.clone().extract({ left: 20, top: 20, width: 100, height: 100 }).pipe(secondWritableStream);\n * readableStream.pipe(pipeline);\n * // firstWritableStream receives auto-rotated, resized readableStream\n * // secondWritableStream receives auto-rotated, extracted region of readableStream\n *\n * @returns {Sharp}\n */\n\nfunction clone() {\n  // Clone existing options\n  const clone = this.constructor.call();\n  clone.options = Object.assign({}, this.options); // Pass 'finish' event to clone for Stream-based input\n\n  if (this._isStreamInput()) {\n    this.on('finish', () => {\n      // Clone inherits input data\n      this._flattenBufferIn();\n\n      clone.options.bufferIn = this.options.bufferIn;\n      clone.emit('finish');\n    });\n  }\n\n  return clone;\n}\n\nObject.assign(Sharp.prototype, {\n  clone\n});\n/**\n * Export constructor.\n * @private\n */\n\nmodule.exports = Sharp;","map":{"version":3,"sources":["/media/gabriel/HD/Cursos/OmniStack 7.0/aulas/node_modules/sharp/lib/constructor.js"],"names":["util","require","stream","is","hasVendoredLibvips","err","help","message","test","push","process","platform","error","join","Error","debuglog","Sharp","input","options","arguments","length","defined","Duplex","call","topOffsetPre","leftOffsetPre","widthPre","heightPre","topOffsetPost","leftOffsetPost","widthPost","heightPost","width","height","canvas","position","resizeBackground","useExifOrientation","angle","rotationAngle","rotationBackground","rotateBeforePreExtract","flip","flop","extendTop","extendBottom","extendLeft","extendRight","extendBackground","withoutEnlargement","kernel","fastShrinkOnLoad","tintA","tintB","flatten","flattenBackground","negate","medianSize","blurSigma","sharpenSigma","sharpenFlat","sharpenJagged","threshold","thresholdGrayscale","trimThreshold","gamma","gammaOut","greyscale","normalise","brightness","saturation","hue","booleanBufferIn","booleanFileIn","joinChannelIn","extractChannel","removeAlpha","ensureAlpha","colourspace","composite","fileOut","formatOut","streamOut","withMetadata","withMetadataOrientation","resolveWithObject","jpegQuality","jpegProgressive","jpegChromaSubsampling","jpegTrellisQuantisation","jpegOvershootDeringing","jpegOptimiseScans","jpegOptimiseCoding","jpegQuantisationTable","pngProgressive","pngCompressionLevel","pngAdaptiveFiltering","pngPalette","pngQuality","pngColours","pngDither","webpQuality","webpAlphaQuality","webpLossless","webpNearLossless","webpSmartSubsample","webpReductionEffort","tiffQuality","tiffCompression","tiffPredictor","tiffPyramid","tiffSquash","tiffTile","tiffTileHeight","tiffTileWidth","tiffXres","tiffYres","heifQuality","heifLossless","heifCompression","tileSize","tileOverlap","tileSkipBlanks","tileBackground","linearA","linearB","queueListener","queueLength","queue","emit","_createInputDescriptor","allowStream","inherits","clone","constructor","Object","assign","_isStreamInput","on","_flattenBufferIn","bufferIn","prototype","module","exports"],"mappings":"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","sourcesContent":["'use strict';\n\nconst util = require('util');\nconst stream = require('stream');\nconst is = require('./is');\n\nrequire('./libvips').hasVendoredLibvips();\n\n/* istanbul ignore next */\ntry {\n  require('../build/Release/sharp.node');\n} catch (err) {\n  // Bail early if bindings aren't available\n  const help = ['', 'Something went wrong installing the \"sharp\" module', '', err.message, ''];\n  if (/NODE_MODULE_VERSION/.test(err.message)) {\n    help.push('- Ensure the version of Node.js used at install time matches that used at runtime');\n  } else if (/invalid ELF header/.test(err.message)) {\n    help.push(`- Ensure \"${process.platform}\" is used at install time as well as runtime`);\n  } else if (/dylib/.test(err.message) && /Incompatible library version/.test(err.message)) {\n    help.push('- Run \"brew update && brew upgrade vips\"');\n  } else if (/Cannot find module/.test(err.message)) {\n    help.push('- Run \"npm rebuild --verbose sharp\" and look for errors');\n  } else {\n    help.push(\n      '- Remove the \"node_modules/sharp\" directory then run',\n      '  \"npm install --ignore-scripts=false --verbose\" and look for errors'\n    );\n  }\n  help.push(\n    '- Consult the installation documentation at https://sharp.pixelplumbing.com/install',\n    '- Search for this error at https://github.com/lovell/sharp/issues', ''\n  );\n  const error = help.join('\\n');\n  throw new Error(error);\n}\n\n// Use NODE_DEBUG=sharp to enable libvips warnings\nconst debuglog = util.debuglog('sharp');\n\n/**\n * @constructs sharp\n *\n * Constructor factory to create an instance of `sharp`, to which further methods are chained.\n *\n * JPEG, PNG, WebP or TIFF format image data can be streamed out from this object.\n * When using Stream based output, derived attributes are available from the `info` event.\n *\n * Implements the [stream.Duplex](http://nodejs.org/api/stream.html#stream_class_stream_duplex) class.\n *\n * @example\n * sharp('input.jpg')\n *   .resize(300, 200)\n *   .toFile('output.jpg', function(err) {\n *     // output.jpg is a 300 pixels wide and 200 pixels high image\n *     // containing a scaled and cropped version of input.jpg\n *   });\n *\n * @example\n * // Read image data from readableStream,\n * // resize to 300 pixels wide,\n * // emit an 'info' event with calculated dimensions\n * // and finally write image data to writableStream\n * var transformer = sharp()\n *   .resize(300)\n *   .on('info', function(info) {\n *     console.log('Image height is ' + info.height);\n *   });\n * readableStream.pipe(transformer).pipe(writableStream);\n *\n * @example\n * // Create a blank 300x200 PNG image of semi-transluent red pixels\n * sharp({\n *   create: {\n *     width: 300,\n *     height: 200,\n *     channels: 4,\n *     background: { r: 255, g: 0, b: 0, alpha: 0.5 }\n *   }\n * })\n * .png()\n * .toBuffer()\n * .then( ... );\n *\n * @param {(Buffer|String)} [input] - if present, can be\n *  a Buffer containing JPEG, PNG, WebP, GIF, SVG, TIFF or raw pixel image data, or\n *  a String containing the filesystem path to an JPEG, PNG, WebP, GIF, SVG or TIFF image file.\n *  JPEG, PNG, WebP, GIF, SVG, TIFF or raw pixel image data can be streamed into the object when not present.\n * @param {Object} [options] - if present, is an Object with optional attributes.\n * @param {Boolean} [options.failOnError=true] - by default halt processing and raise an error when loading invalid images.\n *  Set this flag to `false` if you'd rather apply a \"best effort\" to decode images, even if the data is corrupt or invalid.\n * @param {Number|Boolean} [options.limitInputPixels=268402689] - Do not process input images where the number of pixels\n *  (width x height) exceeds this limit. Assumes image dimensions contained in the input metadata can be trusted.\n *  An integral Number of pixels, zero or false to remove limit, true to use default limit of 268402689 (0x3FFF x 0x3FFF).\n * @param {Boolean} [options.sequentialRead=false] - Set this to `true` to use sequential rather than random access where possible.\n *  This can reduce memory usage and might improve performance on some systems.\n * @param {Number} [options.density=72] - number representing the DPI for vector images.\n * @param {Number} [options.pages=1] - number of pages to extract for multi-page input (GIF, TIFF, PDF), use -1 for all pages.\n * @param {Number} [options.page=0] - page number to start extracting from for multi-page input (GIF, TIFF, PDF), zero based.\n * @param {Object} [options.raw] - describes raw pixel input image data. See `raw()` for pixel ordering.\n * @param {Number} [options.raw.width]\n * @param {Number} [options.raw.height]\n * @param {Number} [options.raw.channels] - 1-4\n * @param {Object} [options.create] - describes a new image to be created.\n * @param {Number} [options.create.width]\n * @param {Number} [options.create.height]\n * @param {Number} [options.create.channels] - 3-4\n * @param {String|Object} [options.create.background] - parsed by the [color](https://www.npmjs.org/package/color) module to extract values for red, green, blue and alpha.\n * @returns {Sharp}\n * @throws {Error} Invalid parameters\n */\nconst Sharp = function (input, options) {\n  if (arguments.length === 1 && !is.defined(input)) {\n    throw new Error('Invalid input');\n  }\n  if (!(this instanceof Sharp)) {\n    return new Sharp(input, options);\n  }\n  stream.Duplex.call(this);\n  this.options = {\n    // resize options\n    topOffsetPre: -1,\n    leftOffsetPre: -1,\n    widthPre: -1,\n    heightPre: -1,\n    topOffsetPost: -1,\n    leftOffsetPost: -1,\n    widthPost: -1,\n    heightPost: -1,\n    width: -1,\n    height: -1,\n    canvas: 'crop',\n    position: 0,\n    resizeBackground: [0, 0, 0, 255],\n    useExifOrientation: false,\n    angle: 0,\n    rotationAngle: 0,\n    rotationBackground: [0, 0, 0, 255],\n    rotateBeforePreExtract: false,\n    flip: false,\n    flop: false,\n    extendTop: 0,\n    extendBottom: 0,\n    extendLeft: 0,\n    extendRight: 0,\n    extendBackground: [0, 0, 0, 255],\n    withoutEnlargement: false,\n    kernel: 'lanczos3',\n    fastShrinkOnLoad: true,\n    // operations\n    tintA: 128,\n    tintB: 128,\n    flatten: false,\n    flattenBackground: [0, 0, 0],\n    negate: false,\n    medianSize: 0,\n    blurSigma: 0,\n    sharpenSigma: 0,\n    sharpenFlat: 1,\n    sharpenJagged: 2,\n    threshold: 0,\n    thresholdGrayscale: true,\n    trimThreshold: 0,\n    gamma: 0,\n    gammaOut: 0,\n    greyscale: false,\n    normalise: 0,\n    brightness: 1,\n    saturation: 1,\n    hue: 0,\n    booleanBufferIn: null,\n    booleanFileIn: '',\n    joinChannelIn: [],\n    extractChannel: -1,\n    removeAlpha: false,\n    ensureAlpha: false,\n    colourspace: 'srgb',\n    composite: [],\n    // output\n    fileOut: '',\n    formatOut: 'input',\n    streamOut: false,\n    withMetadata: false,\n    withMetadataOrientation: -1,\n    resolveWithObject: false,\n    // output format\n    jpegQuality: 80,\n    jpegProgressive: false,\n    jpegChromaSubsampling: '4:2:0',\n    jpegTrellisQuantisation: false,\n    jpegOvershootDeringing: false,\n    jpegOptimiseScans: false,\n    jpegOptimiseCoding: true,\n    jpegQuantisationTable: 0,\n    pngProgressive: false,\n    pngCompressionLevel: 9,\n    pngAdaptiveFiltering: false,\n    pngPalette: false,\n    pngQuality: 100,\n    pngColours: 256,\n    pngDither: 1,\n    webpQuality: 80,\n    webpAlphaQuality: 100,\n    webpLossless: false,\n    webpNearLossless: false,\n    webpSmartSubsample: false,\n    webpReductionEffort: 4,\n    tiffQuality: 80,\n    tiffCompression: 'jpeg',\n    tiffPredictor: 'horizontal',\n    tiffPyramid: false,\n    tiffSquash: false,\n    tiffTile: false,\n    tiffTileHeight: 256,\n    tiffTileWidth: 256,\n    tiffXres: 1.0,\n    tiffYres: 1.0,\n    heifQuality: 80,\n    heifLossless: false,\n    heifCompression: 'hevc',\n    tileSize: 256,\n    tileOverlap: 0,\n    tileSkipBlanks: -1,\n    tileBackground: [255, 255, 255, 255],\n    linearA: 1,\n    linearB: 0,\n    // Function to notify of libvips warnings\n    debuglog: debuglog,\n    // Function to notify of queue length changes\n    queueListener: function (queueLength) {\n      Sharp.queue.emit('change', queueLength);\n    }\n  };\n  this.options.input = this._createInputDescriptor(input, options, { allowStream: true });\n  return this;\n};\nutil.inherits(Sharp, stream.Duplex);\n\n/**\n * Take a \"snapshot\" of the Sharp instance, returning a new instance.\n * Cloned instances inherit the input of their parent instance.\n * This allows multiple output Streams and therefore multiple processing pipelines to share a single input Stream.\n *\n * @example\n * const pipeline = sharp().rotate();\n * pipeline.clone().resize(800, 600).pipe(firstWritableStream);\n * pipeline.clone().extract({ left: 20, top: 20, width: 100, height: 100 }).pipe(secondWritableStream);\n * readableStream.pipe(pipeline);\n * // firstWritableStream receives auto-rotated, resized readableStream\n * // secondWritableStream receives auto-rotated, extracted region of readableStream\n *\n * @returns {Sharp}\n */\nfunction clone () {\n  // Clone existing options\n  const clone = this.constructor.call();\n  clone.options = Object.assign({}, this.options);\n  // Pass 'finish' event to clone for Stream-based input\n  if (this._isStreamInput()) {\n    this.on('finish', () => {\n      // Clone inherits input data\n      this._flattenBufferIn();\n      clone.options.bufferIn = this.options.bufferIn;\n      clone.emit('finish');\n    });\n  }\n  return clone;\n}\nObject.assign(Sharp.prototype, { clone });\n\n/**\n * Export constructor.\n * @private\n */\nmodule.exports = Sharp;\n"]},"metadata":{},"sourceType":"script"}